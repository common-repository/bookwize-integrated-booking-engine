var step1,step2,step3,step4,IBEStepsMain,myReservation,guestPreferences,loader,ratePlan,lang,header;$(document).ready(function(){("object"!=typeof google||"object"!=typeof google.maps)&&$.getScript("https://maps.googleapis.com/maps/api/js?key=AIzaSyAwNrMVC8KUcrJXw5ceZbJJ6NP2rK37TBQ",function(){})});var routes={1:"Step1",2:"Step2",3:"Step3",4:"Step4",Rateplan:"Rateplan",MyReservation:"MyReservation",Account:"Account",Contact:"Contact"};!function(e){"use strict";function t(){var t=this;t.lang=ko.observable(""),t.currency=ko.observable(""),t.ready=ko.observable(!1),t.updateCustomerPreferences=ko.observable(!1),t.existAcceptCookie=ko.observable(!1),t.acceptCookie=function(){var e="cookieconsent_status",a=document.cookie.indexOf(e);return-1!==a?(t.existAcceptCookie(!0),!0):!1},t.addTrackingScripts=function(){IBE.Config.userCookieAcceptance=!0;var t=IBE.Data.HotelInfo[IBE.Config.hotelId].settings;try{t.adwordsConversionId&&gtag("config","AW-"+t.adwordsConversionId,{anonymize_ip:!0})}catch(a){IBE.Utils.consoleLog(a.message)}try{t.facebook_TrackId&&(fbq("init",t.facebook_TrackId),fbq("track","PageView"))}catch(o){IBE.Utils.consoleLog(o.message)}try{t.bingCode&&e("body").append('<img src="//bat.bing.com/action/0?ti='+t.bingCode+'e&Ver=2" height="0" width="0" style="display:none;visibility: hidden;" />')}catch(s){IBE.Utils.consoleLog(s.message)}},t.existAcceptCookie.subscribe(function(e){e&&t.addTrackingScripts()}),t.ready.subscribe(function(a){loader.visible(!a),a&&(t.acceptCookie(),e(document).on("click",".cc-allow",t.acceptCookie),e(".dropdown").removeClass("open"),t.applyBodyClass(),e.wait(500).then(t.animate.steps),e.wait(500).then(function(){t.navigationSteps(t.currentStep-1)}))}),t.metaTitles=["Step 1 - Booking Engine","Step 2 - Booking Engine","Step 3 - Booking Engine","Step 4 - Booking Engine","Contact- Booking Engine","My Reservation - Booking Engine"],t.currentStep=1,t.layouts=["rows","grid"],t.layout=0,t.muktipleRooms=1,t.theme="d",t.themes=[{element:e("#Header"),themes:{a:"a",b:"a",c:"c",d:"c",e:"c"}},{element:e("#ReservationContainer #Step1"),themes:{a:"a",b:"a",c:"c",d:"d",e:"d"}},{element:e("#ReservationContainer #Step2"),themes:{a:"a",b:"a",c:"b",d:"c",e:"c"}},{element:e("#ReservationContainer #Step3"),themes:{a:"e",b:"e",c:"b",d:"b",e:"e"}},{element:e("#ReservationContainer #Step4"),themes:{a:"b",b:"b",c:"b",d:"b",e:"b"}}],t.isIntegratedPage=function(){var e=!1;if(!(IBEConfig.integrated_page.length<=0))return(window.location.href.indexOf(IBEConfig.integrated_page)>-1||window.location.href.indexOf(IBEConfig.integrated_page+"?page=MyReservation")>-1)&&(e=!0),e},t.setTheme=function(){t.isIntegratedPage()&&(e(".ibe-body").addClass("theme-"+t.theme),e.each(t.themes,function(e,a){if(a.element.length){var o=a.themes[t.theme],s=a.element.data("template").replace("%theme%",o);a.element.attr("data-template",s).data("template",s)}}))},t.onReadyEvents={step1:function(a){if(a){t.metaTitles=[IBE.Utils.translate("meta.title.1"),IBE.Utils.translate("meta.title.2"),IBE.Utils.translate("meta.title.3"),IBE.Utils.translate("meta.title.4"),IBE.Utils.translate("meta.title.contact"),IBE.Utils.translate("meta.title.myreservation")],""!==IBE.Utils.getReservationSetting(step1,"WelcomeMessage")&&IBE.Utils.bindTemplate("WelcomeMessage",step1),e(".bookwize-integrated .btn-primary").css("background",IBE.Config.bwButtonColor),e(".bookwize-integrated-form .btn-primary").css("background",IBE.Config.bwButtonColor);var s=IBE.Utils.parseDeepLinking(window.location.search,step1);s===!1?("1"!==t.getParam(window.location.search,"page")&&History.pushState({page:"1"},t.metaTitles[0],"?page=1"),t.ready(a),e(".steps").show(),t.scrollTo({offset:0,duration:0}),t.animate.stepContent(),e(document).on("click",".request-mealplan",function(){t.readMore()}),e(".step1-offers .slide").length<=1&&e(".step1-offers .slide-prev, .step1-offers .slide-next").hide()):o(s)}},step2:function(a){function s(){guestPreferences=new IBE.ViewModels.Step1ViewModel,guestPreferences.couponCode=step1.couponCode,guestPreferences.couponValid=step1.couponValid,guestPreferences.boardTypes=step1.boardTypes,guestPreferences.boardType=step1.boardType,guestPreferences.hasMessage=step1.hasMessage,guestPreferences.message=step1.message,guestPreferences.bookingProcess=step2.bookingProcess,guestPreferences.lang=step1.lang,guestPreferences.validate=function(e){t.updateCustomerPreferences(!0),step1.couponCode(e.couponCode()),step1.checkIn(guestPreferences.checkIn()),step1.checkOut(guestPreferences.checkOut()),step1.requestedRooms(guestPreferences.requestedRooms()),step1.validate()},guestPreferences.cancelDateChange=function(){guestPreferences.checkIn(step1.checkIn()),guestPreferences.checkOut(step1.checkOut())},guestPreferences.cancelRoomChange=function(){guestPreferences.requestedRooms.removeAll(),ko.utils.arrayForEach(step1.requestedRooms(),function(e){guestPreferences.requestedRooms.push(e)})},guestPreferences.events.subscribe(function(e){e&&(guestPreferences.checkIn(step1.checkIn()),guestPreferences.checkOut(step1.checkOut()),guestPreferences.couponCode(step1.couponCode()),guestPreferences.requestedRooms.removeAll(),guestPreferences.boardType(step2.request().preferredBoard()),ko.utils.arrayForEach(step1.requestedRooms(),function(e){guestPreferences.requestedRooms.push(e)}))},this,"ready"),guestPreferences.events.subscribe(function(e){e.success&&o(e.success),e.failure&&guestPreferences.message(e.failure)},this,"submit"),guestPreferences.init(),e.when(IBE.Utils.bindTemplate("GuestPreferences",guestPreferences)).then(function(){e(document).on("click",".booking-process .well .navbar-collapse, .booking-process .well .navbar-collapse *",function(t){t.stopImmediatePropagation();var a=e("#GuestPreferences-Step1");a.is(":hidden")?(e("#GuestPreferences-Step1").stop().slideDown(),e("#GuestPreferences-Step1").addClass("open"),e(".bookwize-integrated .btn-primary").css("background",IBE.Config.bwButtonColor)):(e("#GuestPreferences-Step1").stop().slideUp(),e("#GuestPreferences-Step1").removeClass("open"))})}),step1.dispose()}t.layout=IBE.Utils.getReservationSetting(step2,"IbeRoomsViewMode"),a&&(IBE.Utils.destroyView("Step1"),e.when(IBE.Utils.bindTemplate("Step2",step2)).then(function(){if(e(".bookwize-integrated .btn-book").css("background",IBE.Config.bwButtonColor),e(".bookwize-integrated .best-value").css("border-bottom-color",IBE.Config.bwButtonColor),e(".bookwize-integrated .badge.bar").css("color",IBE.Config.bwButtonColor),s(),History.pushState({page:"2"},t.metaTitles[1],"?page=2"),t.ready(a),e(".steps").show(),t.scrollTo({offset:0,duration:0}),t.animate.bgImage(),e.wait(500).then(t.animate.stepContent(".step2-content")),e(window).on("resize",t.resize),t.roomRowStyles(),"a"==t.theme){var o=190;e(window).scroll(function(){var t=e(window).scrollTop();0>o-t?(e(".booking-process").addClass("fixed"),e(".ui-tabs-nav").addClass("fixed")):(e(".booking-process").removeClass("fixed"),e(".ui-tabs-nav").removeClass("fixed"))})}e(".room-row").on("click",".book-room-button",t.bookRoom),e(".room-row").on("click",".list-row",t.animateRateplanViewButton.show),e(document).on("click",".room-row .room-info",t.popup.open),e(document).on("click",".room-row .row-left",t.popup.open),e(document).on("click",".room-row .room-header span:eq(0)",t.popup.open),e(document).on("click",".room-row .list-row .rateplan-view-btn",t.popup.open),e(document).on("click","#GuestPreferences .dropdown-menu",function(t){return e(t.target).hasClass("btn-cancel")?(e(".dropdown-toggle").dropdown("toggle"),!0):void t.stopImmediatePropagation()}),e(document).on("click",".change-layout li",t.toggleLayout),e(".change-layout li[data-layout='"+t.layouts[t.layout]+"']").trigger("click"),e(".room-list").on("click",".row-left",function(){return t.layout==t.layouts[1]?(t.openRoomOverlay(e(this)),!1):void 0}),e(".room-list").on("click",".room-row",function(){t.layout==t.layouts[1]&&t.closeRoomOverlay(e(this))})}))},step3:function(a){t.ready(a),e(".steps").show(),a&&(IBE.Utils.destroyView("Step2"),e.when(IBE.Utils.bindTemplate("Step3",step3)).then(function(){e(".bookwize-integrated .btn-primary").css("background",IBE.Config.bwButtonColor),step2.dispose(),History.pushState({page:"3"},t.metaTitles[2],"?page=3"),t.scrollTo({offset:0}),e(".supplement-tooltip").on("click",function(){e(this).parents(".supplement").find(".supplement-description").stop().slideToggle()})}))},step4:function(a){a&&(IBE.Utils.destroyView("Step3"),IBE.Utils.bindTemplate("Step4",step4),History.pushState({page:"4"},t.metaTitles[3],"?page=4"),window.uetq=window.uetq||[],window.uetq.push({ec:step4.reservation().status(),ea:"Transaction",el:"Grand Resort Lagonissi",gv:step4.reservation().totalCost()}),window.optimizely=window.optimizely||[],window.optimizely.push(["trackEvent","eventName",{revenue:100*step4.reservation().totalCost()}]),"undefined"!=typeof fbq&&fbq("track","Purchase",{value:step4.reservation().totalCost(),currency:t.currency()}),t.scrollTo({offset:0}),e(".steps").hide(),e(".supplement-tooltip").on("click",function(){e(this).parents(".supplement").find(".supplement-description").stop().slideToggle()})),t.ready(a)},ratePlan:function(a){a&&(IBE.Utils.bindTemplate("Rateplan",ratePlan),e("#Step1, .steps").css("display","none"),e(".rateplan-page button").on("click",function(){IBE.Utils.destroyView("Rateplan"),e("#Step1, .steps").css("display","block"),History.replaceState(null,"",""),t.setStep(1)})),t.ready(a)},myReservation:function(a){e(".steps").hide(),t.scrollTo({offset:0,duration:0}),t.ready(a),a&&(e("#ReservationContainer").children().each(function(t,a){var o=ko.contextFor(a);o&&(ko.cleanNode(a),e(a).html(""))}),IBE.Utils.destroyView("Contact"),t.animate.stepContent(".myreservation-content"))}},t.isIntegratedPage()&&(t.initStep1=function(){t.currentStep=1,"undefined"==typeof step1&&(step1=new IBE.ViewModels.Step1ViewModel,step1.events.subscribe(function(t){t.success&&(o(t.success),Cache.write("step1_data",t)),t.failure&&(IBE.Utils.consoleLog("Failed to submit step 1"),e("#GuestPreferences .customer-request .promocode .dropdown-toggle").dropdown("toggle"),IBE.Utils.consoleLog(t.failure))},this,"submit"),step1.events.subscribe(function(e){"Forbidden"==e.severity&&t.ready(!1),loader.title("Failed to initialize booking engine :("),loader.message(e),loader.visible(!0),IBE.Utils.logEvent(e)},this,"error"),step1.events.subscribe(function(e){t.onReadyEvents.step1(e)},this,"ready")),step1.lang=t.lang,step1.currency=t.currency,e.when(IBE.Utils.bindTemplate("Step1",step1)).then(function(){step1.init()}),step1.clearMessage()},t.initStep2=function(e){if(t.currentStep=2,"undefined"==typeof step2&&(step2=new IBE.ViewModels.Step2ViewModel,step2.events.subscribe(function(e){s(e)},this,"call"),step2.events.subscribe(function(e){s(e)},this,"submit"),step2.events.subscribe(function(e){t.onReadyEvents.step2(e)},this,"ready"),step2.events.subscribe(function(e){"Forbidden"==e.severity&&t.ready(!1),loader.title("Failed to initialize booking engine :("),loader.message(e),loader.visible(!0),IBE.Utils.logEvent(e)},this,"error")),step2.lang=t.lang,step2.currency=t.currency,"undefined"!=typeof e)try{IBE.Utils.destroyView("Step2"),step2.init(e),"undefined"!=typeof ga&&ga("send","event","step1","submit")}catch(a){return step1.message(a.message),IBE.Utils.logEvent(a),t.ready(!0),!1}else t.onReadyEvents.step2(!0);return!0},t.initStep3=function(e){return t.currentStep=3,"undefined"==typeof step3&&(step3=new IBE.ViewModels.Step3ViewModel,step3.events.subscribe(function(e){n(e)},this,"call"),step3.events.subscribe(function(e){(""!==step3.customer().arrivalTime().value||step3.flightInformation())&&(e.notes+="<ul>",""!==step3.customer().arrivalTime().value&&(e.notes+="<li>"+IBE.Utils.translate("label_arrivalTime")+": "+ko.unwrap(step3.customer().arrivalTime().value)+"</li>"),step3.flightInformation()&&(e.notes+="<li><b>"+IBE.Utils.translate("flightInfo")+"</b></li>",e.notes+="<li>"+IBE.Utils.translate("label_flightNumber")+": "+ko.unwrap(step3.flightInformationDetails.flightNumber)+"</li>",e.notes+="<li>"+IBE.Utils.translate("airportOfArrival")+": "+ko.unwrap(step3.flightInformationDetails.airportOfArrival)+"</li>"),e.notes+="</ul>"),n(e)},this,"submit"),step3.events.subscribe(function(e){t.onReadyEvents.step3(e),step3.addSupplement=function(e){e.quantity()>=e.maxQuantity||e.quantity(parseInt(e.quantity())+1)},step3.removeSupplement=function(e){e.quantity()>e.minQuantity()&&e.quantity(parseInt(e.quantity())-1)}},this,"ready"),step3.events.subscribe(function(e){t.ready(!0),loader.title("Failed to initialize booking engine :("),loader.message(e),loader.visible(!0),IBE.Utils.logEvent(e)},this,"error")),step3.lang=t.lang,step3.currency=t.currency,step3.init(e),"undefined"!=typeof ga&&ga("send","event","step2","submit"),!0},t.initStep4=function(e){t.currentStep=4,"undefined"==typeof step4&&(step4=new IBE.ViewModels.Step4ViewModel,step4.events.subscribe(function(e){n(e)},this,"call"),step4.events.subscribe(function(e){n(e)},this,"submit"),step4.events.subscribe(function(e){t.onReadyEvents.step4(e)},this,"ready"),step4.events.subscribe(function(e){step3.clearMessage(),step3.message(e),"critical"==e.severity&&(loader.title("Failed to submit booking :("),loader.message(e),loader.visible(!0)),IBE.Utils.logEvent(e),t.ready(!0),step3.ready(!0),step3.disableButton(!1)},this,"error")),step4.lang=t.lang,step4.currency=t.currency;try{step4.init(e),"undefined"!=typeof ga&&ga("send","event","step3","submit")}catch(a){step3.clearMessage();var o={id:"4001",severity:a.severity,text:a.text||a.message};return step3.message(o),IBE.Utils.logEvent(o),t.ready(!0),!1}return!0},t.initRatePlan=function(){var e=t.getParam(window.location.search,"rp");""==e&&(History.replaceState(null,"",""),t.setStep(1)),"undefined"==typeof ratePlan&&(ratePlan=new IBE.ViewModels.Step1ViewModel,ratePlan.events.subscribe(function(e){t.onReadyEvents.ratePlan(e)},this,"ready"));try{ratePlan.setRateplan(parseInt(e))}catch(a){return t.setStep(1),!1}return!0},t.initMyReservation=function(){t.currentStep="-myreservation",t.ready(!1),"undefined"==typeof myReservation&&(myReservation=new IBE.ViewModels.MyReservation({email:IBE.Utils.getParam(window.location.search,"email"),code:IBE.Utils.getParam(window.location.search,"code")}),myReservation.events.subscribe(function(e){t.onReadyEvents.myReservation(e)},this,"ready"),myReservation.events.subscribe(function(){t.setStep(1)},this,"logout"),myReservation.events.subscribe(function(){},this,"login"),myReservation.events.subscribe(function(e){t.ready(!0),myReservation.ready(!0),myReservation.clearMessage(),myReservation.message(e),"critical"==e.severity&&(loader.title("Failed to fetch booking :("),loader.message(e),loader.visible(!0)),IBE.Utils.logEvent(e)},this,"error")),t.destroyStep(2),t.destroyStep(3),t.destroyStep(4),t.destroyStep("guestPreferences"),myReservation.lang=t.lang,myReservation.currency=t.currency;try{e.when(IBE.Utils.bindTemplate("MyReservation",myReservation)).then(function(){myReservation.init()})}catch(a){return t.ready(!0),myReservation.message(a),!1}return!0},t.setStep=function(a,o){t.currentStep=a,t.ready(!1),loader.visible(!0);switch(a){case 1:t.destroyStep(2),t.destroyStep(3),t.destroyStep(4),t.initStep1();break;case 2:t.destroyStep(3),t.destroyStep(4),t.initStep2(o),step2.selectedRooms().length>0&&(step2.selectedRooms().splice(step2.tabsCount-1,step2.tabsCount),e(".ui-tabs li:last-child").trigger("click"));break;case 3:if(t.destroyStep(4),"undefined"==typeof o){t.ready(!0);break}t.initStep3(o);break;case 4:if("undefined"==typeof o){t.ready(!0);break}t.initStep4(o);break;default:t.ready(!0)}e(document).on("click",".culture .view-all-currencies",function(e){e.stopPropagation()}),e(document).on("click",".yamm .dropdown-menu",function(e){e.stopPropagation()}),e(document).on("click",".request-mealplans .btn",function(){e(".request-mealplans .btn").removeClass("active"),e(this).addClass("active")})},t.animateRateplanViewButton={show:function(){e(this).parents(".table-list").find(".label-free-cancellation").removeClass("label-active"),e(this).parents(".table-list").find(".rateplan-view-btn").removeClass("active"),e(this).parents(".table-list").find(".rateplan-name .text").css({marginLeft:0}),e(this).find(".rateplan-view-btn").addClass("active"),e(this).find(".label-free-cancellation").addClass("label-active");var t=e(this).find(".rateplan-view-btn").width()+30;e(this).find(".rateplan-name .text").css({marginLeft:t})},reset:function(){e(".table-list .rateplan-view-btn.active").removeClass("active"),e(".table-list .label-free-cancellation.label-active").removeClass("label-active"),e(".table-list .rateplan-name .text").css({marginLeft:0})}},t.readMore=function(){e(".mealplan-description").readmore({speed:277,maxHeight:105,moreLink:'<div class="readmore-js-toggle">'+IBE.Utils.translate("readMore")+"</div>",lessLink:'<div class="readmore-js-toggle">'+IBE.Utils.translate("close")+"</div>"})},t.destroyStep=function(e){switch(e){case 1:IBE.Utils.destroyView("Step1"),step1&&(step1.dispose(),step1=void 0);break;case 2:IBE.Utils.destroyView("Step2"),step2&&(step2.dispose(),step2=void 0);break;case 3:IBE.Utils.destroyView("Step3"),step3&&(step3.dispose(),step3=void 0);break;case 4:IBE.Utils.destroyView("Step4"),step4&&(step4.dispose(),step4=void 0);break;case"guestPreferences":IBE.Utils.destroyView("GuestPreferences"),guestPreferences&&(guestPreferences.dispose(),guestPreferences=void 0)}},t.navigationSteps=function(a){e(".steps .step").on("click",function(){}),e(".steps .step").removeClass("active").removeClass("inactive"),e(".steps .step").each(function(o){(o>a||4==t.currentStep)&&e(this).addClass("inactive"),o==a&&e(this).addClass("active")}),e("[data-dots]").each(function(){for(var t="",a=0;a<e(this).data("dots");a++)t+='<span class="dot"></span>';e(this).html(t)})},t.bookRoom=function(){t.scrollTo({offset:0})},t.applyBodyClass=function(){for(var a=e("body").attr("class").split(" "),o=0;o<a.length;o++)"step"===a[o].slice(0,4)&&e("body").removeClass(a[o]);e("body").addClass("step"+t.currentStep)},t.resize=function(){try{t.resizeRoomImages()}catch(e){}},t.resizeRoomImages=function(){var a=e(window).width();990>=a&&(step2.roomImageWidth(964),step2.roomImageHeight(250)),a>990&&1200>=a&&("grid"==t.layout?(step2.roomImageWidth(964),step2.roomImageHeight(250)):(step2.roomImageWidth(291),step2.roomImageHeight(210)))},t.toggleLayout=function(a){a.stopPropagation();var o=e(".change-layout li.active").data("layout"),s=e(this).data("layout");t.layout=s,e(".change-layout li").removeClass("active"),e(this).addClass("active");var n=e(".room-list");n.removeClass("layout-"+o),n.addClass("layout-"+s),n.addClass("anim"),"grid"==s?(n.find(".room-row").addClass("col-lg-4"),n.find(".room-row .row-right .room-action").addClass("clearfix"),n.find(".room-row .row-right .room-prices").addClass("col-lg-6"),n.find(".room-row .row-right .booking-action").addClass("col-lg-6 no-padding")):(n.find(".room-row").removeClass("col-lg-4"),n.find(".room-row .row-right .room-action").removeClass("clearfix"),n.find(".room-row .row-right .room-prices").removeClass("col-lg-6"),n.find(".room-row .row-right .booking-action").removeClass("col-lg-6"),n.find(".room-row .row-right .booking-action").removeClass("no-padding"),n.find(".table-list").slideDown(300)),t.resizeRoomImages(),t.roomRowStyles()},t.popup={$el:null,events:function(a,o){t.popup.$el.off("shown.bs.modal"),t.popup.$el.off("hidden.bs.modal"),t.popup.$el.on("shown.bs.modal",function(){e("html").addClass("modal-open"),e(".modal-backdrop").height(e(document).height()),t.popup.accordion(),t.animateRateplanViewButton.reset(),t.popup.selectMenu(o),a.find(".popup-rateplan .book-room-button button").on("click",function(){t.popup.close(),t.bookRoom()})}),t.popup.$el.on("hidden.bs.modal",function(){e("html").removeClass("modal-open")})},open:function(){var a=!0;t.layout==t.layouts[1]&&(e(this).hasClass("row-left")||e(this).hasClass("room-header"))&&(t.openRoomOverlay(e(this)),a=!1),a&&(t.popup.$el=e(document).find("#RoomPopUp"),t.popup.events(t.popup.$el,e(this)),t.popup.$el.modal("show"))},close:function(){e("#RoomPopUp").modal("hide"),e("body").removeClass("modal-open"),e(".modal-backdrop").remove()},accordion:function(){e("#ReservationContainer").on("shown.bs.collapse",".panel-collapse",function(){var t=e(this).parents(".panel");t.find("a .fa-caret-down").hide(),t.find("a .fa-caret-up").show()}),e("#ReservationContainer").on("hidden.bs.collapse",".panel-collapse",function(){var t=e(this).parents(".panel");t.find("a .fa-caret-down").show(),t.find("a .fa-caret-up").hide()})},selectMenu:function(e){var a=e.data("target");"undefined"==typeof a&&(a="room-info"),t.popup.$el.find(".sidebar .list-group .list-group-item[data-target='"+a+"']").trigger("click");var o=e.data("rateplanId"),s=e.parents(".room-row").data("room-id");"undefined"!=typeof o&&t.popup.$el.find(".nav-pills li a[data-rateplan-id='"+o+"']").trigger("click"),IBE.Utils.gaTrack({action:"send",command:"event",data:"/step2/popup/room-"+s})}},t.openRoomOverlay=function(t){e(".room-list").removeClass("anim");var a=t.parents(".room-row");a.find(".row-left").stop().slideUp(577),a.find(".table-list").stop().slideDown(377)},t.closeRoomOverlay=function(a){e(".room-list").removeClass("anim"),a.find(".row-left").slideDown(300,function(){a.find(".row-left").removeAttr("style")}),a.find(".table-list").slideUp(300,function(){a.find(".table-list").removeAttr("style")}),t.roomRowStyles(a)},t.roomRowStyles=function(t){var a=function(t){var a=t.length;a>=3&&t.eq(a-1).css({borderBottom:"none"}),a>3&&e(this).find(".row-center").css({"-webkit-border-radius":"0px 0px 2px 2px","border-radius":"0px 0px 2px 2px"})};if("undefined"!=typeof t){var o=t.find(".table-list .list-row");return void a(o)}e(".room-list .room-row").each(function(){var t=e(this).find(".table-list .list-row");a(t)})}),t.scrollTo=function(t){t=e.extend({offset:0,duration:177,callback:function(){}},t),e("html:not(:animated), body:not(:animated)").animate({scrollTop:t.offset},{duration:t.duration,complete:function(){t.callback()}})},t.animate={bgImage:function(t){t=t||".background-image";var a=e(t);a.addClass("animating")},stepContent:function(t){t=t||".step1-content";var a=e(t);a.addClass("animating")},steps:function(t){t=t||".steps";var a=e(t);a.addClass("animating")},roomRow:function(t){t=t||".room-row";var a=e(t);a.addClass("animating")}},t.pushStates=function(){History.options.hashChangeInterval=500,e(document).on("click",".ibe .steps .step",function(a){var o=e(this),s=e(this).find("a").attr("href"),n=e(this).find("a").attr("title"),i=t.getParam(s,"page");return o.is(".step.inactive")?!1:t.currentStep==t.getParam(s,"page")?!1:(""!=i&&(a.preventDefault(),routes.hasOwnProperty(i)?History.pushState({page:t.getParam(s,"page")},n,s):History.pushState({page:"1"},t.metaTitles[0],"?page=1"),t.closeAnimatedElements()),!0)})},t.getParam=function(e,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a=new RegExp("[\\?&]"+t+"=([^&#]*)"),o=a.exec(e);return null==o?"":decodeURIComponent(o[1].replace(/\+/g," "))},t.isPageStateActive=function(){var e=t.getParam(window.location.search,"page");return e==History.getState().data.page},t.closeAnimatedElements=function(){var t=[".header-sidebar",".reservation-container"];e.each(t,function(t,a){e.each(e(a),function(t,a){var o=e(a).attr("class").split(" ");e(o).each(function(e,t){o[e]=-1===t.indexOf("animate-")?t:""}),e(a).attr("class",o.join(" "))})})},t.getPostByBookwizeLiquidPageType=function(e){return ko.utils.arrayFirst(IBE.Config.pages,function(t){return t.bookwize_liquid_page_type==e})||{}}}function a(){var t=this,a=ko.observable(!1);t.$loader=e(".loader"),t.title=ko.observable("Please wait ..."),t.message=ko.observable(new IBE.Models.Message),t.showError=ko.computed(function(){return"critical"==t.message().severity}),t.clear=function(){t.message(new IBE.Models.Message),t.title("")},t.reload=function(){t.clear(),window.location.reload()},t.visible=ko.computed({read:function(){return a()},write:function(e){a(t.message().id>0?!0:e),a()?t.$loader.show():t.$loader.hide()}}).extend({notify:"always"})}function o(e){IBEStepsMain.isIntegratedPage()&&e&&(i=!0,IBEStepsMain.ready(!1),IBEStepsMain.setStep(2,e))}function s(e){IBEStepsMain.isIntegratedPage()&&e&&(i=!0,IBEStepsMain.ready(!1),IBEStepsMain.setStep(3,e))}function n(e){IBEStepsMain.isIntegratedPage()&&e&&(i=!0,IBEStepsMain.ready(!1),IBEStepsMain.setStep(4,e))}if("undefined"==typeof e&&"undefined"!=typeof jQuery)var e=jQuery;e.wait=function(t){var a=e.Deferred();return setTimeout(function(){a.resolve()},t),a};var i=!1;IBEStepsMain=new t,e(function(){function t(){var e=n.scrollTop();e>10?r.hide():r.show()}if(lang=e("html").attr("lang"),function(e){if(IBEStepsMain.isIntegratedPage()){var t=IBEStepsMain.getParam(e.location.search,"theme");""!=t&&(IBEStepsMain.theme=t),IBEStepsMain.setTheme();var a=IBEStepsMain.getParam(e.location.search,"rooms");""!=a&&(IBEStepsMain.multipleRooms=a)}var s=IBEStepsMain.getParam(e.location.search,"lang");s&&s[3]&&-1!=IBE.Config.languages.indexOf(s[3])&&(lang=s[3]),IBEStepsMain.isIntegratedPage()&&(History.Adapter.onDomLoad(function(){var t=History.getState();if("undefined"==typeof t.data.page){var a=IBEStepsMain.getParam(e.location.search,"page");if(""==a){var o=IBEStepsMain.getParam(e.location.search,"rp");""!=o&&(a="rp")}t.data.page=""==a?"1":a}switch(t.data.page=""+t.data.page,t.data.page.toLocaleLowerCase()){case"account":case"myreservation":IBEStepsMain.initMyReservation();break;case"contact":IBEStepsMain.initContact();break;case"rp":IBEStepsMain.initRatePlan();break;default:var s=Cache.read("ReservationUser");if(s!==!1){IBEStepsMain.setStep(4,s);break}IBEStepsMain.setStep(1)}}),History.Adapter.bind(e,"statechange",function(){var t=History.getState(),a=History.savedStates,s=a[a.length-2];if(1==t.data.page.length&&s.data.page<t.data.page&&0==i&&History.pushState({page:s.data.page+""},IBEStepsMain.metaTitles[s.data.page-1],"?page="+s.data.page),"4"==s.data.page&&t.data.page<s.data.page&&(t.data.page="1"),"4"==t.data.page&&"3"!=s.data.page){if(Cache.read("ReservationUser")!==!1)return!0;t.data.page="1"}if("3"==t.data.page&&"2"!=s.data.page&&(t.data.page="1"),IBEStepsMain.getParam(e.location.search,"page")==s.data.page||t.data.page==s.data.page)return!1;IBEStepsMain.popup.close();var n=IBE.Utils.parseDeepLinking(e.location.search,step1);if(n!==!1)return o(n),!0;switch(routes.hasOwnProperty(t.data.page)||History.pushState({page:"1"},IBEStepsMain.metaTitles[0],"?page=1"),1==t.data.page.length&&s.data.page>t.data.page&&1==i&&(i=!1),t.data.page=""+t.data.page,t.data.page.toLocaleLowerCase()){case"account":case"myreservation":IBE.Utils.prepareView("myreservation"),IBEStepsMain.initMyReservation();break;case"contact":IBE.Utils.prepareView("contact"),IBEStepsMain.initContact();break;case"rp":IBE.Utils.prepareView("rateplan"),IBEStepsMain.initRatePlan();break;case"1":case"2":case"3":case"4":var r=t.data.page;IBE.Utils.prepareView(r),IBEStepsMain.setStep(parseInt(r));break;default:IBE.Utils.consoleLog("invalid url:"+t.data.step)}}))}(window),IBEStepsMain.formModel=ko.observable(!1),e(".bookwize-integrated-form").length){step1=new IBE.ViewModels.Step1ViewModel,step1.init();var s=0;step1.submit=function(e){if(e){var t=step1.checkIn().format("YYYY-MM-DD"),a=step1.checkOut().format("YYYY-MM-DD");ko.utils.arrayForEach(step1.requestedRooms()[0].guests,function(e){s+="Adult"===e.ageCategory()?e.pax():("/"+e.fromAge()).repeat(e.pax())});var o=step1.boardType();window.location.href=IBE.Config.integrated_page+"?page=2&ci="+t+"&co="+a+"&r="+s+"&board="+o}e.failure&&IBE.Utils.consoleLog("Failed to submit step 1")},e(".bookwize-integrated-form .btn-primary").css("background",IBE.Config.bwButtonColor),e(".bookwize-integrated-form").show()}loader=new a,loader.visible(!0),ko.applyBindings(loader,document.getElementById("Loader")),IBEStepsMain.isIntegratedPage()&&(header=new IBE.ViewModels.HeaderViewModel,lang?header.lang(lang):header.lang(e("html").attr("lang")),IBEStepsMain.lang=header.lang,IBEStepsMain.currency=header.currency),IBEStepsMain.isIntegratedPage()&&e.when(IBE.Utils.bindTemplate("Header",header)).then(function(){header.init()}),e("#Currency").length&&e.when(IBE.Utils.bindTemplate("Currency",header)).then(function(){header.init()}),IBEStepsMain.pushStates();var n=e(window),r=e(".site-branding");n.on("scroll",t),t()})}(jQuery);
